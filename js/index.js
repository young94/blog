!function(t){t.fn.searchMatching=function(a){var i=function(t,a){this.opt=a,this.obj=t,this.dat={ipt:"",dat:null},this.txt=t.attr("value"),this.rule={l:/^[A-Za-z]*$/,c:/^[0-9A-Za-z\u4e00-\u9fa5]*$/,not:/[`~!@#$%^&*_+=￥（）()<>?:"{},.\/;'[\]！。......，…——、‘；—【】|？》《“：\\\-”0-9 ]/g},this.init()};i.prototype={init:function(){var t=this;t.opt.dat&&t.eventFun()},eventFun:function(){var a=this;a.obj.focus(function(){a.obj.val()==a.txt?(a.obj.val(""),a.opt.focusBlankFun&&a.opt.focusBlankFun()):a.opt.focusFun&&a.opt.focusFun()}),a.obj.blur(function(){""==a.obj.val()?(a.obj.val(a.txt),a.opt.blurBlankFun&&a.opt.blurBlankFun()):a.opt.blurFun&&a.opt.blurFun()}),a.obj.keyup(function(i){var e=i||window.event||arguments.callee.caller.arguments[0];e.keyCode>=37&&e.keyCode<=40||13==e.keyCode||(""!=t(this).val()?(a.dat.ipt=t(this).val(),a.searchEvent(a.dat.ipt)):a.opt.blankFun&&a.opt.blankFun())})},searchEvent:function(a){var i=this;if(i.opt.dat instanceof Array)1==i.opt.type?i.rule.c.test(a)&&(i.dat.dat=i.matchC(a)):2==i.opt.type?i.rule.l.test(a)&&(i.dat.dat=i.matchL(a)):i.rule.l.test(a)?i.dat.dat=i.matchL(a):i.rule.c.test(a)&&(i.dat.dat=i.matchC(a)),i.opt.cbFun&&i.opt.cbFun.apply(t.extend({},i.dat));else{for(k in i.opt.dat)i.dat.dat=i.dat.dat?i.dat.dat:{},1==i.opt.type?i.rule.c.test(a)&&(i.dat.dat[k]=i.matchC(a,i.opt.dat[k])):2==i.opt.type?i.rule.l.test(a)&&(i.dat.dat[k]=i.matchL(a,i.opt.dat[k])):i.rule.l.test(a)?i.dat.dat[k]=i.matchL(a,i.opt.dat[k]):i.rule.c.test(a)&&(i.dat.dat[k]=i.matchC(a,i.opt.dat[k]));i.opt.cbFun&&i.opt.cbFun.apply(t.extend({},i.dat))}},matchC:function(t,a){for(var i=this,e=a?a:i.opt.dat,n=[],o=0;o<e.length;o++){var s,d,c=t.length;if(e[o][i.opt.cn]&&-1!=e[o][i.opt.cn].indexOf(t)){var l=e[o][i.opt.cn].indexOf(t);s=e[o][i.opt.cn].substring(0,l),d=e[o][i.opt.cn].substring(l+c),e[o].cnDom='<span class="mch-cn"><strong class="mch-get">'+s+"</strong>"+t+'<strong class="mch-get">'+d+"</strong></span>",n.push(e[o])}}return n},matchL:function(t,a){for(var i=this,e=a?a:i.opt.dat,n=[],o=0;o<e.length;o++){var s=t.length;if(e[o][i.opt.py]&&0==e[o][i.opt.py].toLowerCase().indexOf(t.toLowerCase())){var d=e[o][i.opt.py].substring(0,s),c=e[o][i.opt.py].substring(s);e[o].pyDom='<span class="mch-py"><strong class="mch-get">'+d+"</strong>"+c+"</span>",n.push(e[o])}else e[o][i.opt.sx]&&0==e[o][i.opt.sx].toLowerCase().indexOf(t.toLowerCase())&&(delete e[o].pyDom,n.push(e[o]))}return n}};var e={dat:null,type:0,sx:"sx",py:"py",cn:"cn",focusFun:null,focusBlankFun:null,blurFun:null,blurBlankFun:null,cbFun:null,blankFun:null,ph:"placehoder"};a=t.extend(e,a),this.each(function(){new i(t(this),a)})}}(jQuery),function(t){t.fn.SwiperScrollBase=function(a){var i=function(t,a){this.opt=a,this.obj=t,this.init()};i.prototype={init:function(){var t=this;t.tEvents()},tEvents:function(){for(var a=this,i=a.obj.find(a.opt.upbtn),e=a.obj.find(a.opt.downbtn),n=a.obj.find(a.opt.box),o=0,s=0;s<n.children(a.opt.itbox).length;s++)"none"!=n.children(a.opt.itbox).eq(s).css("display")&&o++;var d=n.children(a.opt.itbox).outerWidth(!0),c=0;c="number"==typeof a.opt.getviewwidthbox?a.opt.getviewwidthbox:t("body").find(a.opt.getviewwidthbox).width();var l=parseInt(c/d),r=a.opt.movenum>0?a.opt.movenum:l;l=a.opt.ismoveOne?1:r;var m=Math.ceil(o/r),u=o%l==0?l:parseInt(o%l),p=a.opt.isbigFirst?n.children(a.opt.bigFirstbox).outerWidth(!0):0,h=d*o+p,v=!1,f=u!=l?parseInt(c-u*d):0;i.hide(),n.css({width:h,position:"relative"}).attr("data-swiper-page","1"),a.obj.find(".shadowleft").hide(),a.obj.find(".shadowright").show(),1==m&&(e.hide(),a.obj.find(".shadowright").hide()),i.on("click",function(){e.show(),a.obj.find(".shadowright").show();var t=parseInt(n.attr("data-swiper-page")),o=d*l*1;2==t&&(i.hide(),a.obj.find(".shadowleft").hide()),a.opt.isbigFirst&&2==t&&(o=o-2*d+p),a.opt.ismoveOne&&(o=1*d),a.opt.isbigFirst||(o=r*d*1),v&&(v=!1,o-=f),n.attr("data-swiper-page",t-1),2==t?n.animate({left:"0px"}):n.animate({left:"+="+o+"px"},50)}),e.on("click",function(){i.show(),a.obj.find(".shadowleft").show();var t=parseInt(n.attr("data-swiper-page")),o=d*l*-1;a.opt.isbigFirst&&1==t&&(o=o+2*d-p),a.opt.ismoveOne&&(o=-1*d),a.opt.isbigFirst||(o=r*d*-1),(t+1>=m&&1!=t||2==m&&1==t)&&(e.hide(),a.obj.find(".shadowright").hide(),v=!0,o+=f),n.attr("data-swiper-page",t+1),n.animate({left:"+="+o+"px"},50)})}};var e={box:'[data-plugin="swiper-box"]',itbox:'[data-plugin="swiper-itbox"]',upbtn:'[data-plugin="swiper-upbtn"]',downbtn:'[data-plugin="swiper-downbtn"]',isbigFirst:!1,ismoveOne:!1,movenum:0,bigFirstbox:'[data-plugin="swiper-bigfirst"]',getviewwidthbox:"body"};a=t.extend(e,a),this.each(function(){new i(t(this),a)})}}(jQuery),function(t){function a(t){var a=[],e=[864e5,36e5,6e4,1e3,1];for(i=0;i<e.length;i++)a[i]=Math.floor(t/e[i]),t%=e[i];this.format=function(t){var i={"\\$d+":a[0],"\\$h+":a[1],"\\$m+":a[2],"\\$s+":a[3],"\\$S+":a[4]};for(var e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length>2?2:(""+i[e]).length)));return t},this.getD=function(){return a}}t.fn.Countdown=function(i){var e={ct:null,st:null,et:null,gap:1e3,aEven:null,iEven:null,lEven:null,sEven:null};if(t.extend(e,i),null!=e.ct&&null!=e.et&&null!=e.aEven&&null!=e.st){e.iEven&&e.iEven.apply(e);var n=setInterval(function(){if(e.st>e.ct)t.extend(e,{dt:new a(e.st-e.ct)}),e.ct>=e.st&&(e.ct=e.st,clearInterval(n),e.dt=new a(e.st-e.ct)),e.sEven.apply(e);else{if(t.extend(e,{dt:new a(e.et-e.ct)}),e.ct>=e.et)return e.ct=e.et,clearInterval(n),e.dt=new a(e.et-e.ct),void(e.lEven&&e.lEven.apply(e));e.aEven.apply(e)}e.ct=e.ct+e.gap},e.gap)}}}(jQuery),function(t){t.fn.MCD=function(a){var i=function(a,i){this.opt=i,this.obj=a,this.cache={movieCount:0,cinemaCount:0,movieList:null,cinemaList:null,date:null,cityId:decodeURIComponent(t.cookie("defaultCity")).split("|")[1],cityName:decodeURIComponent(t.cookie("defaultCity")).split("|")[0],chooseMid:null,chooseCid:null},this.cinemaData={cinemas:[],favCinemas:[]},this.movieBox=this.obj.find(this.opt.movieBox),this.cinemaBox=this.obj.find(this.opt.cinemaBox),this.init()};i.prototype={init:function(){var t=this;t.initData()},initData:function(){var a=this;ajax.getAjax({Jurl:"http://service.theater"+site_domain+"/Cinema.api",JdataType:"script",Jparams:{Ajax_CallBack:!0,Ajax_CallBackType:"Mtime.Cinema.Services",Ajax_CallBackMethod:"GetOnlineMoviesInCity",Ajax_CrossDomain:1,Ajax_RequestUrl:"",t:(new Date).getTime(),Ajax_CallBackArgument0:a.cache.cityId},Jmethod:"getOnlineMoviesInCityResult",Jback:function(){this.data&&this.data.value&&(a.cache.movieList=this.data.value.movies,a.cache.movieCount=a.cache.movieList.length,a.cache.cinemaCount=this.data.value.cinemaCount,a.movieHtml())}}),ajax.getAjax({Jurl:"http://service.theater"+site_domain+"/Cinema.api",JdataType:"script",Jparams:{Ajax_CallBack:!0,Ajax_CallBackType:"Mtime.Cinema.Services",Ajax_CallBackMethod:"GetOnlineTheatersByMovieIdInCity",Ajax_CrossDomain:1,Ajax_RequestUrl:"",t:(new Date).getTime(),Ajax_CallBackArgument0:a.cache.cityId,Ajax_CallBackArgument1:"",Ajax_CallBackArgument2:!0},Jmethod:"getOnlineTheatersByMovieIdInCityResult",Jback:function(){if(this.data&&this.data.value){a.cache.cinemaCount=this.data.value.cinemas.length,a.cinemaData.cinemas=this.data.value.cinemas;for(var t=0;t<a.cinemaData.cinemas.length;t++){var i=a.cinemaData.cinemas[t].name.replace(/[^a-z]+/gi,"");""!=i&&(a.cinemaData.cinemas[t].py=i)}a.cinemaData.favCinemas=this.data.value.favCinemas,this.data.value.cinemas=fmt.dataSort(this.data.value.cinemas,"districtId"),this.data.value.cinemas=fmt.groupByKey(this.data.value.cinemas,"districtId"),a.cache.cinemaList=this.data.value,a.cinemaHtml()}}}),t(document).mousedown(function(i){var e=a.obj,n=t(a.getEvent(i)).parents().is(e);n||(a.obj.find('[data-plugin="mcd-movie-list"]').hide(),a.obj.find('[data-plugin="mcd-cinema-list"]').hide(),a.obj.find('[data-plugin="mcd-date-list"]').hide())}),a.obj.find('[data-plugin="mcd-fast-buy"]').addClass("btnfalse"),a.obj.find('[data-plugin="mcd-date-box"]').addClass("nottime"),a.obj.find('[data-plugin="mcd-date-list"]').remove()},movieHtml:function(t){var a=this;a.obj.find('[data-plugin="mcd-movie-list"]')[0]&&!t&&a.obj.find('[data-plugin="mcd-movie-list"]').remove();var i=t?t:a.cache.movieList,e=a.cache.movieCount,n=null,o=[];a.obj.find(a.opt.movieCount).text(e);for(var s=0;s<i.length;s++){var d=""==i[s].rating?"":'<b class="moviegrade">'+i[s].rating+"</b>",c='                <li>                  <a href="javascript:;" movie-id="'+i[s].movieId+'"data-pan="M16_Index_Hotplay_TicketSearch_Movie">'+d+'<em data-plugin="mcd-movie-itname">'+i[s].title+"</em>                  </a>                </li>";o.push(c)}t?a.movieBox.find('[data-plugin="mcd-movie-item"]').html(o.join("")):(n='          <div class="moviestip" data-plugin="mcd-movie-list" style="display:none">            <div class="searcher fix">              <input type="text" data-plugin="search-movie" class="input c_a5" value="输入影片名称快速定位" data-pan="M16_Index_Hotplay_TicketSearch_Movie_Input">              <i class="sub"></i>            </div>            <ul data-plugin="mcd-movie-item">'+o.join("")+"</ul>          </div>",a.movieBox.append(n),a.movieSearch()),a.afterRender()},cinemaHtml:function(t){var a=this;t||a.obj.find('[data-plugin="mcd-cinema-list"]')[0]&&a.obj.find('[data-plugin="mcd-cinema-list"]').remove();var i=a.cache.cinemaList.districts,e=t?t.cinemas:a.cache.cinemaList.cinemas,n=t?t.favCinemas:a.cache.cinemaList.favCinemas,o=a.cache.cinemaCount,s=null,d=[];a.obj.find(a.opt.cinemaCount).text(o);for(var c=0;c<i.length;c++){var l=null,r=null,m=[];r="<span>"+i[c].name+"</span>",e[i[c].districtId]||(e[i[c].districtId]=[]);for(var u=0;u<e[i[c].districtId].length;u++){var p='              <a href="javascript:;" cinema-id="'+e[i[c].districtId][u].cinemaId+'" cinema-sid="'+e[i[c].districtId][u].stringId+'" data-pan="M16_Index_Hotplay_TicketSearch_Cinema_Choose">'+e[i[c].districtId][u].name+"</a>";m.push(p)}m.length>0&&(l='              <p class="oftenlist alist" district-id="'+i[c].districtId+'">                '+r+m.join("")+"              </p>"),d.push(l)}if(n&&n.length>0){for(var h=[],v=0;v<n.length;v++){_itF='              <a href="javascript:;" cinema-id="'+n[v].cinemaId+'" cinema-sid="'+n[v].stringId+'" data-pan="M16_Index_Hotplay_TicketSearch_Cinema">'+n[v].name+"</a>",h.push(_itF)}_itemF='            <p class="oftenlist alist">              <span>常去影院</span>              '+h.join("")+"            </p>"}else _itemF="";t?a.obj.find('[data-plugin="mcd-cinema-result"]').html(_itemF+d.join("")):(s='            <div class="cinematip" data-plugin="mcd-cinema-list" style="display:none;">              <p class="fix">                <span class="searcher">                  <input type="text" class="input c_a5" data-plugin="search-cinema" value="输入影院名称快速定位" data-pan="M16_Index_Hotplay_TicketSearch_Cinema_Input">                  <i class="sub"></i>                </span>                <span class="cinemanum">当前共有'+o+'家影院</span>              </p>              <div data-plugin="mcd-cinema-result" class="arealist">'+_itemF+d.join("")+"</div>            </div>",a.cinemaBox.append(s),a.cinemaSearch()),a.afterRender()},dateHtml:function(){var a=this,i=a.cache.date.dates,e=a.cache.date.dateShowtimes,n=null,o=[],s=[],d=fmt.dateFormat(new Date,0,"YY-MM-DD"),c=0;a.obj.find('[data-plugin="mcd-date-list"]')[0]&&a.obj.find('[data-plugin="mcd-date-list"]').remove();for(var l=0;l<i.length;l++){var r=i[l].split("-"),m=null,u=0==l?"on":"";a.opt.todayMark&&(d==i[l]?(c=l,u="on"):u=""),m='            <dd class="'+u+'" data-plugin="tab-itnav" data-plugin="swiper-itbox" data-pan="M16_Index_Hotplay_TicketSearch_Time_Time">'+fmt.countWeek(r.join(""))+"("+Number(r[1])+"月"+Number(r[2])+"日)</dd>",o.push(m)}for(var p=0;p<e.length;p++){for(var h=null,v=[],f=e[p].showtimes,g=0;g<f.length;g++){var b=f[g].isNext?"<i>(次日)</i>":"",x='                  <li>                    <a href="http://piao'+site_domain+"/onlineticket/showtime/"+f[g].showtimeId+'/" target="_blank" data-pan="M16_Index_Hotplay_TicketSearch_Time_Show">                      <span class="time">'+f[g].timeReal+b+'</span>                      <span class="ting">'+f[g].version+","+f[g].hallName+'</span>                      <span class="mprice">￥'+f[g].salePrice+'<em></em></span>                      <span class="yprice">￥'+f[g].cinemaPrice+' </span>                      <span class="btnblue" data-plugin="mcd-buy">选座购票</span>                    </a>                  </li>                ';v.push(x)}var y=p==c?"block":"none";h='            <div class="showdate" data-plugin="tab-itbox" style="display:'+y+'">              <ul>'+v.join("")+"</ul>            </div>",s.push(h)}if(n='          <div class="i_date" data-plugin="mcd-date-list" id="mcd-date">            <div class="i_datetab">              <a class="lastday" href="javascript:;" data-plugin="swiper-upbtn" data-pan="M16_Index_Hotplay_TicketSearch_Time_Leftbtn"><i></i></a>              <a class="nextday" href="javascript:;" data-plugin="swiper-downbtn" data-pan="M16_Index_Hotplay_TicketSearch_Time_Rightbtn"><i></i></a>              <div class="i_dates">                <div>                  <dl style="width:1000%" data-plugin="tab-nav" data-plugin="swiper-box">'+o.join("")+'</dl>                </div>              </div>            </div>            <div data-plugin="tab-box">'+s.join("")+"</div>          </div>",a.obj.find(a.opt.dateBox).append(n),a.opt.todayMark){var j=-168*c;a.obj.find('[data-plugin="tab-nav"]').css("left",j)}a.obj.find(a.opt.dateBox).tabBase({cur:"on"}),t("#mcd-date").SwiperScrollBase({movenum:1,box:'[data-plugin="tab-nav"]',itbox:'[data-plugin="tab-itnav"]'})},afterRender:function(){var a=this;a.movieBox.off("click"),a.cinemaBox.off("click"),a.obj.find('[data-plugin="mcd-movie-item"] a').off("click"),a.obj.find('[data-plugin="mcd-cinema-list"] a').off("click"),a.obj.find('[data-plugin="mcd-delete"]').off("click"),a.movieBox.on("click",function(){a.obj.find('[data-plugin="mcd-movie-list"]').is(":visible")||(t('[data-plugin="mcd-movie-list"]').show(),t('[data-plugin="mcd-cinema-list"]').hide(),a.obj.find('[data-plugin="mcd-date-list"]')[0]&&a.obj.find('[data-plugin="mcd-date-list"]').hide())}),a.cinemaBox.on("click",function(){t('[data-plugin="mcd-cinema-list"]').show(),t('[data-plugin="mcd-movie-list"]').hide(),a.obj.find('[data-plugin="mcd-date-list"]')[0]&&a.obj.find('[data-plugin="mcd-date-list"]').hide()}),a.obj.find('[data-plugin="mcd-movie-item"] a').on("click",function(){var i=t(this).find('[data-plugin="mcd-movie-itname"]').text(),e=t(this).attr("movie-id");a.cache.chooseMid=e,ajax.getAjax({Jurl:"http://service.theater"+site_domain+"/Cinema.api",JdataType:"script",Jparams:{Ajax_CallBack:!0,Ajax_CallBackType:"Mtime.Cinema.Services",Ajax_CallBackMethod:"GetOnlineTheatersByMovieIdInCity",Ajax_CrossDomain:1,Ajax_RequestUrl:"",t:(new Date).getTime(),Ajax_CallBackArgument0:a.cache.cityId,Ajax_CallBackArgument1:e,Ajax_CallBackArgument2:!0},Jmethod:"getOnlineTheatersByMovieIdInCityResult",Jback:function(){this.data&&this.data.value&&(a.cache.cinemaCount=this.data.value.cinemas.length,a.cinemaData.cinemas=this.data.value.cinemas,a.cinemaData.favCinemas=this.data.value.favCinemas,this.data.value.cinemas=fmt.dataSort(this.data.value.cinemas,"districtId"),this.data.value.cinemas=fmt.groupByKey(this.data.value.cinemas,"districtId"),a.cache.cinemaList=this.data.value,a.cinemaHtml(),a.movieBox.find('[data-plugin="mcd-movie-name"]').text(i),a.movieBox.find('[data-plugin="mcd-movie-cbox"]').hide(),a.movieBox.find('[data-plugin="mcd-movie-list"]').hide(),a.movieCinemaCheck(),a.movieHtml())}})}),a.obj.find('[data-plugin="mcd-cinema-list"] a').on("click",function(){var i=t(this).text(),e=t(this).attr("cinema-id");a.cache.chooseCid=e,t.cookie("cinemaSid",t(this).attr("cinema-sid")),ajax.getAjax({Jurl:"http://service.theater"+site_domain+"/Cinema.api",JdataType:"script",Jparams:{Ajax_CallBack:!0,Ajax_CallBackType:"Mtime.Cinema.Services",Ajax_CallBackMethod:"GetOnlineMoviesInTheater",Ajax_CrossDomain:1,Ajax_RequestUrl:"",t:(new Date).getTime(),Ajax_CallBackArgument0:e,Ajax_CallBackArgument1:!0},Jmethod:"getGetOnlineMoviesInTheaterResult",Jback:function(){this.data&&this.data.value&&(a.cache.movieList=this.data.value.movies,a.cache.movieCount=a.cache.movieList.length,a.cache.cinemaCount=this.data.value.cinemaCount,a.movieHtml(),a.cinemaBox.find('[data-plugin="mcd-cinema-name"]').text(i),a.cinemaBox.find('[data-plugin="mcd-cinema-cbox"]').hide(),a.obj.find('[data-plugin="mcd-cinema-list"]').hide(),a.movieCinemaCheck())}})}),a.obj.find('[data-plugin="mcd-delete"]').on("click",function(t){a.obj.find('[data-plugin="mcd-movie-name"]').text("选影片"),a.obj.find('[data-plugin="mcd-movie-name"]').removeClass("namebox"),a.obj.find('[data-plugin="mcd-cinema-name"]').text("找影院"),a.obj.find('[data-plugin="mcd-cinema-name"]').removeClass("namebox"),a.obj.find('[data-plugin="mcd-movie-cbox"]').show(),a.obj.find('[data-plugin="mcd-cinema-cbox"]').show(),a.obj.find('[data-plugin="mcd-date-box"]').addClass("nottime"),a.obj.find('[data-plugin="mcd-delete"]').hide(),a.movieCinemaCheck(),a.initData(),a.stopEvent(t)})},movieCinemaCheck:function(){var a=this;a.obj.find('[data-plugin="mcd-date-box"]').off("click"),a.obj.find('[data-plugin="mcd-fast-buy"]').off("click"),a.obj.find('[data-plugin="mcd-buy"]').off("click");var i=!1,e=!1;"选影片"!=a.obj.find('[data-plugin="mcd-movie-name"]').text()&&(a.movieBox.find('[data-plugin="mcd-delete"]').show(),a.obj.find('[data-plugin="mcd-movie-name"]').addClass("namebox"),i=!0),"找影院"!=a.obj.find('[data-plugin="mcd-cinema-name"]').text()&&(a.cinemaBox.find('[data-plugin="mcd-delete"]').show(),a.obj.find('[data-plugin="mcd-cinema-name"]').addClass("namebox"),e=!0),i&&e&&(a.obj.find('[data-plugin="mcd-date-box"]').removeClass("nottime"),a.obj.find('[data-plugin="mcd-date-box"]').on("click",function(){a.obj.find('[data-plugin="mcd-date-box"]').hasClass("nottime")||a.obj.find('[data-plugin="mcd-date-list"]').is(":visible")||ajax.getAjax({Jurl:"http://service.theater"+site_domain+"/Cinema.api",JdataType:"script",Jparams:{Ajax_CallBack:!0,Ajax_CallBackType:"Mtime.Cinema.Services",Ajax_CallBackMethod:"GetOnlineTicketShowtime",Ajax_CrossDomain:1,Ajax_RequestUrl:"",t:(new Date).getTime(),Ajax_CallBackArgument0:a.cache.chooseMid,Ajax_CallBackArgument1:a.cache.chooseCid},Jmethod:"getOnlineTicketShowtimeResult",Jback:function(){this.data&&this.data.value&&(a.cache.date=this.data.value,a.dateHtml())}})})),i||e?(a.obj.find('[data-plugin="mcd-fast-buy"]').removeClass("btnfalse"),a.obj.find('[data-plugin="mcd-fast-buy"]').on("click",function(){if(!t('[data-plugin="mcd-fast-buy"]').hasClass("btnfalse"))if(i){var e=t.cookie("strIdCity");window.open("http://theater"+site_domain+"/"+e+"/movie/"+a.cache.chooseMid+"/")}else{var n=t.cookie("cinemaSid");window.open("http://theater"+site_domain+"/"+n+"/"+a.cache.chooseCid+"/")}})):a.obj.find('[data-plugin="mcd-fast-buy"]').addClass("btnfalse")},movieSearch:function(){var t=this;t.obj.find('[data-plugin="search-movie"]').searchMatching({type:1,dat:t.cache.movieList,cn:"title",ph:"value",cbFun:function(){t.movieHtml(this.dat)},blankFun:function(){t.movieHtml(t.cache.movieList)}})},cinemaSearch:function(){var t=this,a={};a.cinemas=t.cinemaData.cinemas,a.favCinemas=t.cinemaData.favCinemas,t.obj.find('[data-plugin="search-cinema"]').searchMatching({dat:a,cn:"name",py:"py",ph:"value",cbFun:function(){this.dat.districts=t.cache.cinemaList.districts,this.dat.cinemas=fmt.dataSort(this.dat.cinemas,"districtId"),this.dat.cinemas=fmt.groupByKey(this.dat.cinemas,"districtId"),t.cinemaHtml(this.dat)},blankFun:function(){t.cinemaHtml(t.cache.cinemaList)}})},getEvent:function(t){return t=t||window.event,t.target||t.srcElement},stopEvent:function(t){t=t||window.event,t&&t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}};var e={movieBox:'[data-plugin="mcd-movie-box"]',cinemaBox:'[data-plugin="mcd-cinema-box"]',dateBox:'[data-plugin="mcd-date-box"]',movieCount:'[data-plugin="mcd-movie-count"]',cinemaCount:'[data-plugin="mcd-cinema-count"]',todayMark:!0,movieCallBack:null,cinemaCallBack:null,dateCallBack:null};a=t.extend(e,a),this.each(function(){new i(t(this),a)})}}(jQuery),function(t){t.fn.mCities=function(a){var e=function(t,a){this.opt=a,this.obj=t,this.cities=null,this.cache=null,this.tabIdx=0,this.init()};e.prototype={init:function(){var t=this;t.eventClick()},eventClick:function(){var a=this;a.obj.find(a.opt.cityShow).on("click",function(){var t=a.obj.find('[data-plugin="city-list"]');a.opt.preFun&&a.opt.preFun(),t[0]?t.is(":visible")?t.hide():t.show():a.cityHtml()}),t(document).mousedown(function(i){var e=a.obj,n=t(a.getEvent(i)).parents().is(e);n||a.obj.find('[data-plugin="city-list"]').hide()})},groupByIdx:function(t){var a=JSON.parse(t),e=fmt.dataSort(a,"count").slice(-50).reverse(),n=fmt.groupByKey(a,"idx"),o={};e={hot:e};var s=["G","L","T","Z"];for(k in s)for(i in n){if(!(s[k]>=i))break;o[s[k]]=o[s[k]]?o[s[k]]:{},o[s[k]][i]=n[i],delete n[i]}return o=fmt.extendsFun(e,o),window.localStorage&&sessionStorage.setItem("gCities",JSON.stringify(o)),o},cityHtml:function(){function t(t){var e=a.groupByIdx(t),n=null,o=[];for(g in e){var s=null;if("hot"==g){var d=[],c=null;for(h in e[g])c='                  <li>                    <a value="'+e[g][h].id+'">'+e[g][h].nameCn+"</a>                  </li>",d.push(c);s='                <div class="selcity_tiplist" data-plugin="city-list-item">                  <div class="citylist fix">                    <ul data-plugin="city-item-i">                      '+d.join("")+"                    </ul>                  </div>                </div>"}else{var l=[],r=null;for(k in e[g]){var d=[],c=null;for(i in e[g][k])c='                    <li>                      <a value="'+e[g][k][i].id+'">'+e[g][k][i].nameCn+"</a>                    </li>",d.push(c);r='                  <div class="citylist fix">                    <span class="capsletter">'+k+'</span>                    <ul data-plugin="city-item-i">                      '+d.join("")+"                    </ul>                  </div>",l.push(r)}s='                <div class="selcity_tiplist" data-plugin="city-list-item" style="display:none;">                  '+l.join("")+"                </div>"}o.push(s)}n='            <div class="selcity_tip" data-plugin="city-list">              <div class="selcity_tiptit fix">                <div class="citysearch" data-plugin="city-search-box">                  <input type="text" data-pan="M16_Index_Hotplay_TicketSearch_City_Input" data-plugin="city-search" class="text c_a5" autocomplete="off" value="直接输入城市或城市拼音">                </div>                <span class="cityletter" data-plugin="tab-nav">                  <a href="javascript:void(0);" class="on" data-plugin="tab-itnav" data-pan="M16_Index_Hotplay_TicketSearch_City_Hot">热门</a>                  <a href="javascript:void(0);" data-plugin="tab-itnav" data-pan="M16_Index_Hotplay_TicketSearch_City">A-G</a>                  <a href="javascript:void(0);" data-plugin="tab-itnav" data-pan="M16_Index_Hotplay_TicketSearch_City">H-L</a>                  <a href="javascript:void(0);" data-plugin="tab-itnav" data-pan="M16_Index_Hotplay_TicketSearch_City">M-T</a>                  <a href="javascript:void(0);" data-plugin="tab-itnav" data-pan="M16_Index_Hotplay_TicketSearch_City">W-Z</a>                </span>              </div>              '+o.join("")+"            </div>",a.obj.append(n),a.afterRender()}var a=this;window.localStorage&&sessionStorage.getItem("cities")?(a.cities=sessionStorage.getItem("cities"),t(sessionStorage.getItem("cities"))):apiAjax.getCities(function(){for(var i=this.data,e=i.locations.List,n=[],o=0;o<e.length;o++){var s={},d=e[o].Districts.List,c=0;c+=e[o].Cinemas.List.length;for(var l=0;l<d.length;l++)c+=d[l].Cinemas.List.length;s.id=e[o].Id,s.nameCn=e[o].NameCn,s.nameEn=e[o].NameEn,s.idx=e[o].NameEn.substring(0,1).toUpperCase(),s.sx=e[o].PinyinShort,s.count=c,n.push(s)}a.cities=JSON.stringify(n),t(JSON.stringify(n))})},afterRender:function(){var a=this;a.obj.find('[data-plugin="city-item-i"] a').off("click"),a.obj.find('[data-plugin="search-match-list"] li').off("click"),a.obj.tabBase({box:'[data-plugin="city-list"]',itbox:'[data-plugin="city-list-item"]',cur:"on",cbFun:function(){a.tabIdx=this.tabIdx,a.obj.find('[data-plugin="search-result"]').hide()}}),a.obj.find('[data-plugin="city-item-i"] a').on("click",function(){a.cityItemChoose(t(this),t(this).text())}),a.obj.find('[data-plugin="city-search"]').searchMatching({dat:JSON.parse(a.cities),ph:"value",py:"nameEn",cn:"nameCn",focusFun:function(){a.obj.find('[data-plugin="search-result"]')[0]&&a.obj.find('[data-plugin="search-result"]').show()},focusBlankFun:function(){a.obj.find('[data-plugin="city-list-item"]').eq(a.tabIdx).hide(),a.searchResult()},blurBlankFun:function(){return a.obj.find('[data-plugin="search-match-list"]')[0]?void a.obj.find('[data-plugin="search-match-list"] li').on("click",function(){a.cityItemChoose(t(this),t(this).find('[data-plugin="search-match-name"]').text())}):(a.obj.find('[data-plugin="city-list-item"]').eq(a.tabIdx).show(),void a.obj.find('[data-plugin="search-result"]').remove())},blankFun:function(){a.searchResult()},cbFun:function(){a.searchResult(this.ipt,this.dat)}})},cityItemChoose:function(a,i){var e=this,n=i,o=a.attr("value"),s=e.obj.find(e.opt.cityShowName);e.cache={},e.cache.name=n,e.cache.id=o,e.obj.find('[data-plugin="city-list"]').hide(),s.text(e.cache.name),s.attr(e.opt.cityShowId,e.cache.id),t.cookie("defaultCity",encodeURI(e.cache.name+"|"+e.cache.id)),t.cookie("DefaultCity-CookieKey",encodeURI(e.cache.id),{domain:site_domain}),e.obj.find('[data-plugin="city-list-item"]').eq(e.tabIdx).show(),e.obj.find('[data-plugin="city-search"]').val("直接输入城市或城市拼音"),e.obj.find('[data-plugin="search-result"]').remove(),e.opt.cbFun&&e.opt.cbFun.apply(t.extend({},e.cache))},searchResult:function(a,i){var e=this;e.obj.find('[data-plugin="search-result"]')[0]&&e.obj.find('[data-plugin="search-result"]').remove();var n="",o=i?i.length>0?a+"，按拼音数排序":"对不起，找不到："+a:"输入中文/拼音或按↑↓选择",s=[];i=i?i.slice(0,9):JSON.parse(e.cities).hot.slice(0,9);for(var d=0;d<i.length;d++){var c=0==d?"on":"";s.push('            <li value="'+i[d].id+'" class="'+c+'">              <span class="fl">'+i[d].nameEn+'</span>              <span class="fr" data-plugin="search-match-name">'+i[d].nameCn+"</span>            </li>")}n='          <div class="sou_window" data-plugin="search-result">            <div class="sou_note">'+o+'</div>              <div class="sou_city">                <ul data-plugin="search-match-list">'+s.join("")+"</ul>              </div>          </div>",e.obj.find('[data-plugin="city-search-box"]').append(n),e.obj.find('[data-plugin="search-match-list"] li').on("click",function(){e.cityItemChoose(t(this),t(this).find('[data-plugin="search-match-name"]').text())}),e.eventKey()},eventKey:function(t){var a=this;a.obj.find('[data-plugin="city-search"]').off("keydown");var i=0,e=a.obj.find('[data-plugin="search-match-list"] li');a.obj.find('[data-plugin="city-search"]').on("keydown",function(){var n=t||window.event||arguments.callee.caller.arguments[0];40==n.keyCode?8>i&&i++:38==n.keyCode&&0!=i&&i--,e.removeClass("on"),e.eq(i).addClass("on"),13==n.keyCode&&a.cityItemChoose(e.eq(i),e.eq(i).find('[data-plugin="search-match-name"]').text())})},getEvent:function(t){return t=t||window.event,t.target||t.srcElement}};var n={cityShow:'[data-plugin="city-show"]',cityShowName:'[data-plugin="city-name"]',cityShowId:"data-id",cbFun:null,preFun:null};a=t.extend(n,a),this.each(function(){new e(t(this),a)})}}(jQuery),function(t){"use strict";function a(a){return this.each(function(){var e=t(this),n=e.data("bs.carousel"),o=t.extend({},i.DEFAULTS,e.data(),"object"==typeof a&&a),s="string"==typeof a?a:o.slide;n||(n=new i(this,o),e.data("bs.carousel",n)),"number"==typeof a?n.to(a):s?n[s]():o.interval&&n.pause().cycle()})}var i=function(a,i){this.$element=t(a),this.$sliderdots=this.$element.find('[data-slidedot="dot"]'),this.options=i,this.cycleable=!!this.$sliderdots.children().length,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.activeStyle={"z-index":3,opacity:1,filter:"alpha(opacity=100)"},this.normalStyle={"z-index":1,opacity:0,filter:"alpha(opacity=0)"},"hover"!=this.options.pause||"ontouchstart"in document.documentElement||this.$element.on("mouseenter",t.proxy(this.pause,this)).on("mouseleave",t.proxy(this.cycle,this))};i.TRANSITION_DURATION=600,i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},i.prototype.pause=function(a){return a||(this.paused=!0),this.cycleable&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.cycle=function(a){return a||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&this.cycleable&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(t){return this.$items=t.parent().children(),this.$items.index(t||this.$active)},i.prototype.getItemForDirection=function(t,a){var i=this.getItemIndex(a),e="prev"==t&&0===i||"next"==t&&i==this.$items.length-1;if(e&&!this.options.wrap)return a;var n="prev"==t?-1:1,o=(i+n)%this.$items.length;return this.$items.eq(o)},i.prototype.to=function(t){var a=this,i=this.getItemIndex(this.$active=this.$element.find('[data-opacity="1"]'));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid",function(){a.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},i.prototype.next=function(){return this.sliding?void 0:this.slide("next")},i.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},i.prototype.slide=function(a,e){var n=this.$element.find('[data-opacity="1"]'),o=e||this.getItemForDirection(a,n),s=this.interval,d="next"==a?"left":"right",c=this;if("1"==o.attr("data-opacity"))return this.sliding=!1;var l=o[0],r=t.Event("slide",{relatedTarget:l,direction:d});if(this.$element.trigger(r),!r.isDefaultPrevented()){if(this.sliding=!0,s&&this.pause(),this.$sliderdots.length){this.$sliderdots.find(".cur").removeClass("cur");var m=t(this.$sliderdots.children()[this.getItemIndex(o)]);m&&m.addClass("cur")}var u=t.Event("slid",{relatedTarget:l,direction:d});return t.support.transition?(n.css(this.normalStyle),o.css(this.activeStyle),n.one("bsTransitionEnd",function(){o.attr("data-opacity","1"),n.attr("data-opacity","0"),c.sliding=!1,setTimeout(function(){c.$element.trigger(u)},0)}).emulateTransitionEnd(i.TRANSITION_DURATION)):(n.css(this.normalStyle),n.attr("data-opacity","0"),o.css(this.activeStyle),o.attr("data-opacity","1"),this.sliding=!1,this.$element.trigger(u)),s&&this.cycle(),this}};var e=t.fn.carousel;t.fn.carousel=a,t.fn.carousel.Constructor=i,t.fn.carousel.noConflict=function(){return t.fn.carousel=e,this};var n=function(i){var e,n=t(this),o=t(n.attr("data-target")||(e=n.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"")),s=t.extend({},o.data(),n.data()),d=n.attr("data-slide-to");d&&(s.interval=!1),a.call(o,s),d&&o.data("bs.carousel").to(d),i.preventDefault()};t(document).on("click.bs.carousel.data-api","[data-slide]",n).on("click.bs.carousel.data-api","[data-slide-to]",n),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var i=t(this);a.call(i,i.data())})})}(jQuery),function(t){t.fn.idValueMatch=function(a){var i=function(t,a){this.opt=a,this.obj=t,this.ids=[],this.returnDat=[],this.init()};i.prototype={init:function(){var t=this;t.opt.dat&&t.returnHtml()},returnHtml:function(){var t=this,a=t.opt.returnHtml.split("VALUE"),i=t.opt.dat;for(k in i){t.returnDat[k]={};var e=t.opt.isPrice?i[k][t.opt.value]/100:i[k][t.opt.value];t.returnDat[k][i[k][t.opt.id]]=a.join(e)}for(j in t.returnDat)for(h in t.returnDat[j]){var n="["+t.opt.putId+'="'+h+'"]';t.obj.find(n).html(t.returnDat[j][h])}}};var e={
dat:null,getId:"get-id",putId:"put-id",id:"id",value:"price",isPrice:!0,returnHtml:"￥<strong>VALUE</strong>"};a=t.extend(e,a),this.each(function(){new i(t(this),a)})}}(jQuery);var rankListItem='<ul>  {@each movies as item}  <li class="fix">    <dl class="mboxofficerank">      <dt>${item.rating}</dt>      <dd>        <a href=${item.movieId} target="_blank" title=${item.movieName}>          <img src="http://static1.mtime.cn/static/images/transparent.gif" data-src=${item.posterImage} width="80" height="120" alt=${item.movieName} />        </a>      </dd>      <dd>        <h3>          <a href=${item.movieId} target="_blank">${item.movieName}</a>        </h3>        <p>${item.weekendBoxOffice ? "周票房" : "昨日"}：${item.yesterdayBoxOffice ? item.yesterdayBoxOffice : item.weekendBoxOffice}</p>        <p>累计：${item.totalBoxOffice}</p>        <p>          <i class="moviegrade">${item.score}</i>        </p>      </dd>    </dl>  </li>  {@/each}</ul><p class="tr">  <a href="#">更多 <i class="gt"></i></a></p>',rankList='<h4>电影票房</h4><dl class="mboxofficetab fix" data-plugin="tab-nav">  <dd class="cur"><span>内地</span></dd>  <dd><span>北美</span></dd>  <dd><span>全球</span></dd></dl><div data-plugin="tab-box">  <div class="boxofficelist" data-ctrl="bx-m"></div>  <div class="boxofficelist" data-ctrl="bx-n" style="display:none;"></div>  <div class="boxofficelist" data-ctrl="bx-g" style="display:none;"></div></div>',apiAjaxMain=function(){this.apiServer=""};apiAjaxMain.prototype={getCities:function(t){var a=fmt.dateFormat(new Date,0,"YY-MM-DD").split("-").join("");ajax.getAjax({Jurl:"http://static1.mtime.cn/"+a+"/Utility/Data/TheaterListBoxData.m",JdataType:"script",Jmethod:"threaterListBoxData",Jcache:!0,Jback:t})},getRankList:function(t){ajax.getAjax({Jurl:this.apiServer+"/json/rank-list",Jback:t})},getGoodsPrice:function(t,a){var i=[];$("body").find("["+t+"]").each(function(){i.push($(this).attr(t))}),ajax.getAjax({Jurl:"http://service.mall"+site_domain+"/Mall.api",JdataType:"script",Jmethod:"GetGoodsPriceAndTagInfoResult",Jparams:{Ajax_CallBack:!0,Ajax_CallBackType:"Mtime.Ecommerce.Services",Ajax_CallBackMethod:"GetGoodsPriceAndTagInfo",Ajax_CrossDomain:1,Ajax_RequestUrl:"",Ajax_CallBackArgument0:i.join(",")},Jback:a})},getMovieState:function(t,a,i){var e=[$("#ticketfirstbox").attr("data-ticketfirstid")],n=[];$("body").find("["+t+"]").each(function(){e.push($(this).attr(t))}),$("body").find("["+a+"]").each(function(){n.push($(this).attr(a))}),ajax.getAjax({Jurl:"http://service.channel"+site_domain+"/Channel.api",JdataType:"script",Jmethod:"indexLoadData15Result",Jparams:{Ajax_CallBack:!0,Ajax_CallBackType:"Mtime.Channel.Services",Ajax_CallBackMethod:"IndexLoadData15",Ajax_CrossDomain:1,Ajax_RequestUrl:"",Ajax_CallBackArgument0:"",Ajax_CallBackArgument1:e.join(","),Ajax_CallBackArgument2:n.join(","),Ajax_CallBackArgument3:""},Jback:i})},getAllMovieState:function(t){ajax.getAjax({Jurl:"http://service.theater"+site_domain+"/Cinema.api",JdataType:"script",Jmethod:"getExistShowtimesMovieIdsResult",Jparams:{Ajax_CallBack:!0,Ajax_CallBackType:"Mtime.Cinema.Services",Ajax_CallBackMethod:"GetExistShowtimesMovieIdsWithTicket",Ajax_CrossDomain:1,Ajax_RequestUrl:"",t:(new Date).getTime()},Jback:t})},getWannaSeeState:function(t,a){ajax.getAjax({Jurl:"http://web.channel"+site_domain+"/movierating/getAttitudebyIds.api",JdataType:"script",Jmethod:"getUserAttitudeByMovieIdsResult",Jparams:{cross:1,random:(new Date).getTime(),movieIds:t},Jcache:!0,Jback:a})},optWannaSee:function(t,a,i){var e="setWant.api"==a?"setWantToMovieResult":"cancelWantToMovieResult";ajax.getAjax({Jurl:"http://web.channel"+site_domain+"/movierating/"+a,JdataType:"script",Jmethod:e,Jparams:{cross:1,random:(new Date).getTime(),movieId:t},Jcache:!0,Jback:i})},getNormalAd:function(t){var a=["NX_M16_HomeIndex_Banner_Hotplay","NX_M16_HomeIndex_Banner_Goods","NX_M16_HomeIndex_Banner_Selected","NX_M16_HomeIndex_Banner_Global","NX_M16_HomeIndex_Banner_Footer"];ajax.getAjax({Jurl:this.apiServer+"/api/normalAdIndex/",Jparams:{regions:a.join(",")},Jcache:!0,Jback:t})},mustPath:function(){}};var apiAjax=new apiAjaxMain;!function(){$("#startRegion")[0]||$("#homeContentRegion").show();var t={getCitiesData:function(){return window.localStorage?sessionStorage.getItem("cities"):null}},i={defaultCity:$.cookie("defaultCity")?decodeURIComponent($.cookie("defaultCity")):null,cities:t.getCitiesData(),ab:$.cookie("abtest")||null},e=function(){};e.prototype={defaulAndMCD:function(){var t=i.defaultCity.split("|");$('[data-plugin="city-name"]').text(t[0]),$('[data-plugin="city-name"]').attr("data-id",t[1]),$("#mcd-box").MCD()},mCitiesPlugin:function(){$("#city-box").mCities({preFun:function(){$('[data-plugin="mcd-movie-list"]').hide(),$('[data-plugin="mcd-cinema-list"]').hide(),$('[data-plugin="mcd-delete"]').hide(),$('[data-plugin="mcd-movie-cbox"]').show(),$('[data-plugin="mcd-cinema-cbox"]').show(),$('[data-plugin="mcd-movie-name"]').removeClass("namebox").text("选影片"),$('[data-plugin="mcd-cinema-name"]').removeClass("namebox").text("找影院")},cbFun:function(){$("#mcd-box").MCD(),n.getMovieTicketState()}})},getMovieTicketState:function(){apiAjax.getMovieState("data-hot-mid","data-nonext-mid",function(){function t(t,a,e){for(var n=0;n<t.length;n++){t[n].btn="",t[n].priceDom="";var o=r+t[n].MovieID+"/";if("data-hot-mid"==a){if(t[n].HasTicket){var s=$('[data-ticketfirstid="'+t[n].MovieID+'"]').attr("data-dt");n>0&&(s=$('[data-hot-mid="'+t[n].MovieID+'"]').attr("data-dt")),t[n].btn=s>c?'<a href="'+o+'" target="_blank" class="btngreen" data-pan="M16_TheaterIndex_Hotplay_Button_'+(n+1)+'">超前预售</a>':'<a href="'+o+'" target="_blank" class="btnblue" data-pan="M16_TheaterIndex_Hotplay_Button_'+(n+1)+'">选座购票</a>',t[n].priceDom=t[n].LowestSalePrice?"<b><strong>"+t[n].LowestSalePrice/100+"</strong>元起</b>":"",0==n&&$('[data-ticketfirstid="'+t[n].MovieID+'"]').html(t[n].priceDom+t[n].btn)}else if(t[n].HasInfo){var d="http://theater"+site_domain+"/movie/"+t[n].MovieID+"/";t[n].btn='<a href="'+d+'" target="_blank" class="btngreen" data-pan="M16_TheaterIndex_Hotplay_Button">查影讯</a>',0==n&&$('[data-ticketfirstid="'+t[n].MovieID+'"]').html(t[n].priceDom+t[n].btn)}$('[data-price-mid="'+t[n].MovieID+'"]').html(t[n].priceDom),$("["+a+'="'+t[n].MovieID+'"]').html(t[n].btn)}else"data-nonext-mid"==a&&(t[n].HasTicket&&(t[n].btn='<a href="'+o+'" target="_blank" class="btngreen" data-pan="M16_TheaterIndex_Upcoming_Button_'+(n+1)+'">超前预售</a>',t[n].priceDom=t[n].LowestSalePrice?"<b><strong>"+t[n].LowestSalePrice/100+"</strong>元起</b>":""),$("[data-person-num]").eq(n).text(i[n]),$("["+a+'="'+t[n].MovieID+'"]').html(t[n].priceDom+t[n].btn))}}var a=JSON.parse(this.data.value.searchData),i=this.data.value.upcomingWantList,e=a.hotplayMovieTotalCount,o=a.hotplayMovieHasTicketList,s=a.upComingTotalCount,d=a.upcomingTicketList,c=fmt.dateFormat(new Date,0,"YY-MM-DD").split("-").join(""),l=this.data&&this.data.value?this.data.value.stringIdCity:"",r="http://theater"+site_domain+"/"+l+"/movie/";$.cookie("strIdCity",l),n.getMovieTicketActs(a),$('[data-count="hot-mticket"]').html(e),$('[data-count="onnext-mticket"]').html(s),t(o,"data-hot-mid",null),t(d,"data-nonext-mid",null)})},getMovieTicketActs:function(t){$("[data-mt-cids]").show();var i=decodeURIComponent($.cookie("defaultCity")).split("|")[1],e=!1;$("[data-mt-cids]").each(function(n){var o=!0,s=$(this).attr("data-mt-aid"),d=$(this).attr("data-mt-cids"),c=$(this).attr("data-mt-type"),l="lottery"==c?t.lotteryList:"event"==c?t.eventList:[];if("other"==c)if(""!=d){d=d.split(",");for(n in d)d[n]==i&&(o=!1,e=!0)}else o=!1,e=!0;else for(a in l)s==l[a].Id&&l[a].HasCinema&&(o=!1,e=!0);o&&$(this).hide()}),e?$('[data-ctrl="mt-acts-tit"]').show():($('[data-ctrl="mt-acts-tit"]').hide(),$("#mt-acts").hide()),$("#mt-acts-cont dl").css("left",0),$("#mt-acts").SwiperScrollBase({getviewwidthbox:"#mt-acts-cont",movenum:2})},normalAdInput:function(){var t=indexTGs;$("#ad-normal-hot").html(t.hot),$("#ad-normal-mall").html(t.mall),$("#ad-normal-recommend").html(t.recommend),$("#ad-normal-funny").html(t.funny),$("#ad-normal-ft").append(t.ft)},wannaSee:function(){apiAjax.getAllMovieState(function(){for(var t=this,a=t.data&&t.data.value?t.data.value:[],i={},e=a.length>0?a[0].showtimepage.split("movie")[0]+"movie/":"",n=0;n<a.length;n++)i[a[n].movieid]=a[n];var o=[];$("#hot-rank").find("[data-guide-mid]").each(function(){var t=$(this).attr("data-guide-mid");i[t]?($(this).find(".btnctrl")[0]&&$(this).find(".btnctrl").remove(),$(this).children(".moviectrl").append('<a href="'+e+t+'" class="btnctrl on" target="_blank">预售</a>')):o.push(t)}),0!=o.length&&apiAjax.getWannaSeeState(o.join(","),function(){for(var t=this.data&&this.data.items?this.data.items:[],a=0;a<t.length;a++){var i=$('[data-guide-mid="'+t[a].movieId+'"]').children(".moviectrl");i.find(".btnctrl")[0]&&i.find(".btnctrl").remove();var e="M16_Index_Choose_Guide_Button"+(a+1);t[a].wantSee?i.append('<a href="javascript:;" data-ctrl="wanna-see" class="btnctrl on" data-pan='+e+">想看</a>"):i.append('<a href="javascript:;" data-ctrl="wanna-see" class="btnctrl" data-pan='+e+">想看</a>")}$('[data-ctrl="wanna-see"]').on("click",function(){var t=$(this),a=t.hasClass("on")?"cancelWant.api":"setWant.api",i=t.parents("dd").attr("data-guide-mid");apiAjax.optWannaSee(i,a,function(){this.data.userLogin&&this.data.success?"setWant.api"==a?t.addClass("on").text("想看"):t.removeClass("on").text("想看"):$("body").login()})})})})}};var n=new e;i.defaultCity?n.defaulAndMCD():(i.defaultCity="北京|290",$.cookie("defaultCity",encodeURI(i.defaultCity)),$.cookie("DefaultCity-CookieKey",encodeURI(i.defaultCity.split("|")[1]),{domain:site_domain}),n.defaulAndMCD()),apiAjax.getGoodsPrice("data-get-id",function(){if(this.data){var t=this.data.value.result;$("body").idValueMatch({dat:t,getId:"data-get-id",putId:"data-get-id"});var a=$('[data-pan^="M16_Index_Mall_AB_Block"]');a.each(function(t){var a=$(this).attr("data-pan");$(this).attr("data-pan",a+"_a")})}}),i.cities?n.mCitiesPlugin():apiAjax.getCities(function(){for(var t=this.data,a=t.locations.List,e=[],o=0;o<a.length;o++){var s={},d=a[o].Districts.List,c=0;c+=a[o].Cinemas.List.length;for(var l=0;l<d.length;l++)c+=d[l].Cinemas.List.length;s.id=a[o].Id,s.nameCn=a[o].NameCn,s.nameEn=a[o].NameEn,s.idx=a[o].NameEn.substring(0,1).toUpperCase(),s.sx=a[o].PinyinShort,s.count=c,e.push(s)}i.cities=e,window.localStorage&&sessionStorage.setItem("cities",JSON.stringify(i.cities)),n.mCitiesPlugin()}),n.getMovieTicketState(),n.normalAdInput(),$("body").TrackerClickBase({adTrack:!0}),$("#ticketregion").tabBase({eve:"mouseenter",itbox:"div",itnav:"dd",cur:"cur"}),$("#rank-list").tabBase({eve:"mouseenter",itbox:"div",itnav:"dd",cur:"cur"}),$("#cinemasalenow").SwiperScrollBase({box:"dl",itbox:"dd",isbigFirst:!0,bigFirstbox:"dt",getviewwidthbox:".ciname-movie"}),$("#cinameonnext").SwiperScrollBase({box:"dl",itbox:"dd",getviewwidthbox:".cinemaregion"}),$(".countdown").each(function(){var t=$(this),a=(new Date).getTime(),i=1*t.attr("data-starttime"),e=1*t.attr("data-endtime"),n=1*t.attr("data-servertime");n>0&&(a=n),$(".countdown").Countdown({ct:a,st:i,et:e,sEven:function(){var a=this.dt.format("$dd").split(""),i=this.dt.format("$hh").split(""),e=this.dt.format("$mm").split(""),n=this.dt.format("$ss").split(""),o=[];for(d in a)o.push("<i>"+a[d]+"</i>");var s="          <p>距开始:</p><p>          "+o.join("")+"<em>天</em>          <i>"+i[0]+"</i><i>"+i[1]+"</i><em>:</em>          <i>"+e[0]+"</i><i>"+e[1]+"</i><em>:</em>          <i>"+n[0]+"</i><i>"+n[1]+"</i></p>";t.html(s)},aEven:function(){var a=this.dt.format("$dd").split(""),i=this.dt.format("$hh").split(""),e=this.dt.format("$mm").split(""),n=this.dt.format("$ss").split(""),o=[];for(d in a)o.push("<i>"+a[d]+"</i>");var s="          <p>距结束:</p><p>          "+o.join("")+"<em>天</em>          <i>"+i[0]+"</i><i>"+i[1]+"</i><em>:</em>          <i>"+e[0]+"</i><i>"+e[1]+"</i><em>:</em>          <i>"+n[0]+"</i><i>"+n[1]+"</i></p>";t.html(s)},lEven:function(){var a="<p>活动结束</p>";t.html(a)}})}),$('[data-plugin="imgLoad"]').pageLoad({e:function(){var t=$(this),a=$('[data-plugin="imgLoad"]').index(t)+1;t.find("img").each(function(){var t=$(this).attr("data-src");t&&$(this).attr("src",t).removeAttr("data-src")}),$('[data-plugin="imgLoad"]').eq(a).find("img").each(function(){var t=$(this).attr("data-src");$(this).attr("src",t).removeAttr("data-src")})}}),$('[data-ctrl="funny-more"]').on("click",function(){for(var t=$('[data-ctrl="funny-news"] dl'),a=t.length,i=!1,e=0;a>e;e++)if(!t.eq(e).is(":visible")){t.eq(e).show(),i=e+1!=a;break}i||($('[data-ctrl="funny-more"]').remove(),$('[data-ctrl="funny-jump"]').show())}),n.wannaSee()}();